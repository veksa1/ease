### ğŸ§¾ `011_data_contract_and_loader.md`

# ğŸ§¾ Ticket 011 â€“ Data Contract + Loader for Hourly Inputs

**Date:** 2025-11-15
**Owner:** Backend / Data
**Status:** ğŸ”§ To Do
**Goal:** Implement a robust loader that maps incoming hourly JSON to model tensors using your augmented features + priors.

---

## ğŸ¯ Objective

* Enforce **schema validation** with Pydantic.
* Map raw values â†’ normalized scores via Ticket 003 normalizer.
* Assemble 24-hour windows per user/day.

---

## ğŸ“‚ Inputs

| File                          | Description             |
| ----------------------------- | ----------------------- |
| `service/schemas.py`          | Request/response models |
| `data/feature_normalizer.pkl` | Scorers + priors        |
| `service/loader.py`           | Mapping functions       |

---

## ğŸ§© Tasks

1. Implement `parse_request(req)` â†’ dict of feature arrays by hour.
2. Apply per-feature scorer â†’ normalized tensor `[T, in_dim]`.
3. Handle missing hours (masking / simple imputation).
4. Return tensor on correct device.

---

## ğŸ§  Integration

* Used by FastAPI routes (Ticket 010).
* Ensures strict compatibility with UI JSON.

---

## âœ… Deliverables

* [ ] `service/loader.py` + unit tests
* [ ] `service/schemas.py` aligned to JSON contract
* [ ] Example payloads in `examples/requests/`

---

> *â€œStrong contracts = fewer surprises.â€*

---